// OoLibrary Copyright (c) wanu@nyagoya
// Released under the MIT license http://opensource.org/licenses/mit-license.php

(oo=oo||{}).async=function(t){var e=new Image;e.onload=t,e.onerror=t,e.src="data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs="},oo.serial=function(t,e){function s(){oo.async(()=>{i.next().done&&e&&e()})}var i=t(s);s()},oo.parallel=function(t,e){var s=0;function i(){oo.async(()=>{0==s--&&e&&e()})}for(var o=t(i);!o.next().done;)s++;i()},oo.asyncCreateImage=function(t,e){var s=new Image;return s.onload=e,s.onerror=e,s.src=t,s},oo.asyncAppendScript=function(t,e){var s=document.createElement("script");s.src=t,s.onload=e,s.onerror=e,document.body.appendChild(s)},oo.asyncLoadText=function(t,e){return oo.ajax("GET",t,null,null,e)},oo.ajaxJson=function(t,e,s,i,o){var a=JSON.stringify(s),r=oo.ajax(t,e,a,"application/json",()=>{"ok"===r.status&&Object.assign(i,JSON.parse(r.text)),o()});return r},oo.ajax=function(t,e,s,i,o){var a={},r=new XMLHttpRequest;return r.open(t,e,!0),r.onload=(()=>{a.text=r.responseText,a.status="ok",o()}),r.onerror=(()=>{a.status="error",o()}),r.onabort=r.onerror,r.ontimeout=r.onerror,"POST"===t&&(r.setRequestHeader("Content-Type",i),r.send(s)),"GET"===t&&r.send(null),a};class OoDrawObject{constructor(){this.context=null,this.show=!0,this.position=new Oo3DVector(0),this.rotation=new Oo3DVector(0),this.scale=new Oo3DVector(1),this.alpha=1,this.blend_mode=oo.blendMode.kNormal}}class OoSprite extends OoDrawObject{constructor(t){super(),this.size=new Oo2DVector(1),this.image=null,t&&t instanceof Image&&(this.image=t,this.size.set(t.width,t.height))}draw(t){if(this.show){var e=t||this.context||oo.env.context;oo.localAlpha(e,this.alpha,()=>{var t=this.size.x*this.scale.x,s=this.size.y*this.scale.y;0===this.rotation.z?e.drawImage(this.image,this.position.x-.5*t,this.position.y-.5*s,t,s):(e.save(),e.setTransform(1,0,0,1,0,0),e.translate(this.position.x,this.position.y),e.rotate(this.rotation.z),e.drawImage(this.image,.5*-t,.5*-s,t,s),e.restore())})}}static create(t){var e=new OoSprite;return t instanceof Image&&(e.image=t,e.size.set(t.width,t.height)),e}}class OoRenderSprite extends OoSprite{constructor(t){super(),t&&t instanceof Image&&(this.size.set(t.width,t.height),this.canvas=document.createElement("canvas"),this.canvas.width=t.width,this.canvas.height=t.height,this.canvas_context=this.canvas.getContext("2d"),this.canvas_context.drawImage(t,0,0),this.image_data=this.canvas_context.getImageData(0,0,t.width,t.height),this.pixel=this.image_data.data,this.image=this.canvas)}create(t,e){this.size.set(t,e),this.canvas=document.createElement("canvas"),this.canvas.width=t,this.canvas.height=e,this.canvas_context=this.canvas.getContext("2d"),this.image_data=this.canvas_context.createImageData(t,e),this.pixel=this.image_data.data,this.image=this.canvas}getCanvasImageData(){return this.canvas_context.getImageData(0,0,this.canvas.width,this.canvas.height)}getPixel(t,e){if(this.pixel&&!(t<0||t>=this.size.x||e<0||e>=this.size.y)){var s=4*(e*this.size.x+t);return[this.pixel[s+0],this.pixel[s+1],this.pixel[s+2],this.pixel[s+3]]}}setPixel(t,e,s){if(this.pixel&&!(t<0||t>=this.size.x||e<0||e>=this.size.y)){var i=4*(e*this.size.x+t);this.pixel[i+0]=s[0],this.pixel[i+1]=s[1],this.pixel[i+2]=s[2],this.pixel[i+3]=s[3]}}updateCanvas(){this.canvas_context.putImageData(this.image_data,0,0)}}class OoTextBox extends OoDrawObject{constructor(t,e,s,i,o,a,r,n,h){super(),this.size=new Oo2DVector(r||0,n||0),this.position=Oo2DVector.create(o||0,a||0).add(this.size.clone().mul(.5)),this.color=i||"#000000",this.text=t||"",this.font_size=e||0,this.linefeed_space=s||0,this.wordwrap_space=s||0,this.align=h||0,this.content_height=0,this.row=[],this.context=null}setRect(t){this.position=new Oo2DVector(t.x+.5*t.w,t.y+.5*t.h),this.size=new Oo2DVector(t.w,t.h)}_setTextAttributes(t){oo.setTextAttributes(t,this.font_size,this.color,"left","top")}createRow(t){var e=t||this.context||oo.env.context;this._setTextAttributes(e);var s={text:"",width:0,line_space:0};this.row=[oo.clone(s)],[...this.text].forEach(t=>{var i=this.row.length-1;if("\n"===t)this.row[i].line_space=this.linefeed_space,this.row.push(oo.clone(s));else{var o=e.measureText(this.row[i].text+t).width;o>this.size.x?(this.row[i].line_space=this.wordwrap_space,this.row.push({text:t,width:e.measureText(t).width,line_space:0})):(this.row[i].text+=t,this.row[i].width=o)}}),this.content_height=0,this.row.forEach(t=>{this.content_height+=this.font_size,this.content_height+=t.line_space})}flush(){this.row=[]}getContentHeight(){return this.content_height}draw(t){if(this.show){var e=t||this.context||oo.env.context;oo.localAlpha(e,this.alpha,()=>{var t=this.size.x*this.scale.x,s=this.size.y*this.scale.y;0===this.row.length&&this.createRow(e),this._setTextAttributes(e);var i=oo.alignY(this.align,this.size.y-this.content_height);this.row.forEach(o=>{var a=oo.alignX(this.align,this.size.x-o.width);e.fillText(o.text,this.position.x+a-.5*t,this.position.y+i-.5*s),i+=this.font_size+o.line_space})})}}}(oo=(oo=oo||{})||{}).aesType={kAes128:0,kAes192:1,kAes256:2},oo.aes=oo.aes||{},oo.aes.kPolynomial=283,oo.aes.kAffineConstant0=31,oo.aes.kAffineConstant1=99,oo.aes.initialized=!1,oo.aes.sub_bytes_table=new Array(256),oo.aes.inv_sub_bytes_table=new Array(256),oo.aes.mix_column_3112_table=new Array(256),oo.aes.mix_column_bd9e_table=new Array(256),oo.aes.sub_byte_mix_column_3112_table=new Array(256),oo.aes.inv_sub_byte_mix_column_bd9e_table=new Array(256);class OoAes{constructor(){oo.aes.initialized||(OoAes._makeSubBytesTable(),OoAes._makeMixColumnTable(),oo.aes.initialized=!0),this._type="aes128",this._key_length=4,this._num_rounds=10,this._encrypt_round_key=new Array(60),this._decrypt_round_key=new Array(60)}static _leftRotate32(t,e){return t<<e|t>>>32-e}static _get32x4(t,e){for(var s=0;s<4;s++)t[s]=e[4*s]|e[4*s+1]<<8|e[4*s+2]<<16|e[4*s+3]<<24}static _put32x4(t,e){for(var s=0;s<4;s++)t[4*s]=255&e[s],t[4*s+1]=e[s]>>>8&255,t[4*s+2]=e[s]>>>16&255,t[4*s+3]=e[s]>>>24}static _mulPolynomial(t,e){for(var s=0,i=0;i<8;i++)s^=e>>>i&1?t<<i:0;for(i=14;i>=8;i--)s>>>i&1&&(s^=oo.aes.kPolynomial<<i-8);return s}static _getMultiplicativeInverse(t){for(var e=1,s=0;s<7;s++)t=OoAes._mulPolynomial(t,t),e=OoAes._mulPolynomial(e,t);return e}static _makeSubBytesTable(){for(var t=0;t<256;t++){for(var e=OoAes._getMultiplicativeInverse(t),s=0,i=oo.aes.kAffineConstant0,o=0;o<8;o++)e>>>o&1&&(s^=i<<o|i>>>8-o);s=255&s^oo.aes.kAffineConstant1,oo.aes.sub_bytes_table[t]=s,oo.aes.inv_sub_bytes_table[s]=t}}static _makeMixColumnTable(){for(var t=0;t<256;t++)oo.aes.mix_column_3112_table[t]=OoAes._mulPolynomial(3,t)<<24|t<<16|t<<8|OoAes._mulPolynomial(2,t),oo.aes.mix_column_bd9e_table[t]=OoAes._mulPolynomial(11,t)<<24|OoAes._mulPolynomial(13,t)<<16|OoAes._mulPolynomial(9,t)<<8|OoAes._mulPolynomial(14,t);for(t=0;t<256;t++){var e=oo.aes.sub_bytes_table[t];oo.aes.sub_byte_mix_column_3112_table[t]=oo.aes.mix_column_3112_table[e],oo.aes.inv_sub_byte_mix_column_bd9e_table[e]=oo.aes.mix_column_bd9e_table[t]}}static _subBytes(t){for(var e=t,s=0;s<16;s++)e[s]=oo.aes.sub_bytes_table[e[s]]}static _invSubBytes(t){for(var e=t,s=0;s<16;s++)e[s]=oo.aes.inv_sub_bytes_table[e[s]]}static _shiftRows(t,e){var s=[0,0,0,0];s[0]=255&t[0]^65280&t[1]^16711680&t[2]^4278190080&t[3],s[1]=255&t[1]^65280&t[2]^16711680&t[3]^4278190080&t[0],s[2]=255&t[2]^65280&t[3]^16711680&t[0]^4278190080&t[1],s[3]=255&t[3]^65280&t[0]^16711680&t[1]^4278190080&t[2];for(var i=0;i<4;i++)t[i]=s[i]}static _invShiftRows(t,e){var s=[0,0,0,0];s[0]=255&t[0]^65280&t[3]^16711680&t[2]^4278190080&t[1],s[1]=255&t[1]^65280&t[0]^16711680&t[3]^4278190080&t[2],s[2]=255&t[2]^65280&t[1]^16711680&t[0]^4278190080&t[3],s[3]=255&t[3]^65280&t[2]^16711680&t[1]^4278190080&t[0];for(var i=0;i<4;i++)t[i]=s[i]}static _mixColumns(t,e){for(var s=0;s<4;s++){var i=oo.aes.mix_column_3112_table[255&t[s]];i^=OoAes._leftRotate32(oo.aes.mix_column_3112_table[t[s]>>>8&255],8),i^=OoAes._leftRotate32(oo.aes.mix_column_3112_table[t[s]>>>16&255],16),i^=OoAes._leftRotate32(oo.aes.mix_column_3112_table[t[s]>>>24],24),t[s]=i}}static _invMixColumns(t,e){for(var s=e;s<e+4;s++){var i=oo.aes.mix_column_bd9e_table[255&t[s]];i^=OoAes._leftRotate32(oo.aes.mix_column_bd9e_table[t[s]>>>8&255],8),i^=OoAes._leftRotate32(oo.aes.mix_column_bd9e_table[t[s]>>>16&255],16),i^=OoAes._leftRotate32(oo.aes.mix_column_bd9e_table[t[s]>>>24],24),t[s]=i}}_addRoundKey(t,e){for(var s=0;s<4;s++)t[s]^=this._encrypt_round_key[4*e+s]}_keyExpansion(t){for(var e=0;e<this._key_length;e++)this._encrypt_round_key[e]=t[4*e]|t[4*e+1]<<8|t[4*e+2]<<16|t[4*e+3]<<24;var s=1;for(e=this._key_length;e<4*(this._num_rounds+1);e++){var i=this._encrypt_round_key[e-1];e%this._key_length==0?(i=oo.aes.sub_bytes_table[i>>>8&255]|oo.aes.sub_bytes_table[i>>>16&255]<<8|oo.aes.sub_bytes_table[i>>>24]<<16|oo.aes.sub_bytes_table[255&i]<<24,i^=s,s=OoAes._mulPolynomial(s,2)):this._key_length>6&&e%this._key_length==4&&(i=oo.aes.sub_bytes_table[255&i]|oo.aes.sub_bytes_table[i>>>8&255]<<8|oo.aes.sub_bytes_table[i>>>16&255]<<16|oo.aes.sub_bytes_table[i>>>24]<<24),this._encrypt_round_key[e]=this._encrypt_round_key[e-this._key_length]^i}for(var o=0;o<this._num_rounds+1;o++)for(e=0;e<4;e++){var a=this._num_rounds-o;this._decrypt_round_key[4*a+e]=this._encrypt_round_key[4*o+e]}for(e=1;e<this._num_rounds;e++)OoAes._invMixColumns(this._decrypt_round_key,4*e)}setKey(t,e){this._type=t,t===oo.aesType.kAes128&&(this._key_length=4,this._num_rounds=10),t===oo.aesType.kAes192&&(this._key_length=6,this._num_rounds=12),t===oo.aesType.kAes256&&(this._key_length=8,this._num_rounds=14),this._keyExpansion(e)}encrypt(t,e){var s=[0,0,0,0],i=[0,0,0,0],o=oo.aes.sub_byte_mix_column_3112_table,a=this._encrypt_round_key,r=0;OoAes._get32x4(s,e);for(var n=0;n<4;n++)s[n]^=a[r++];for(var h=1;h<this._num_rounds;h++)i[0]=o[255&s[0]]^OoAes._leftRotate32(o[s[1]>>>8&255],8)^OoAes._leftRotate32(o[s[2]>>>16&255],16)^OoAes._leftRotate32(o[s[3]>>>24],24)^a[r++],i[1]=o[255&s[1]]^OoAes._leftRotate32(o[s[2]>>>8&255],8)^OoAes._leftRotate32(o[s[3]>>>16&255],16)^OoAes._leftRotate32(o[s[0]>>>24],24)^a[r++],i[2]=o[255&s[2]]^OoAes._leftRotate32(o[s[3]>>>8&255],8)^OoAes._leftRotate32(o[s[0]>>>16&255],16)^OoAes._leftRotate32(o[s[1]>>>24],24)^a[r++],i[3]=o[255&s[3]]^OoAes._leftRotate32(o[s[0]>>>8&255],8)^OoAes._leftRotate32(o[s[1]>>>16&255],16)^OoAes._leftRotate32(o[s[2]>>>24],24)^a[r++],[s,i]=[i,s];var c=oo.aes.sub_bytes_table;i[0]=c[255&s[0]]^c[s[1]>>>8&255]<<8^c[s[2]>>>16&255]<<16^c[s[3]>>>24]<<24^a[r++],i[1]=c[255&s[1]]^c[s[2]>>>8&255]<<8^c[s[3]>>>16&255]<<16^c[s[0]>>>24]<<24^a[r++],i[2]=c[255&s[2]]^c[s[3]>>>8&255]<<8^c[s[0]>>>16&255]<<16^c[s[1]>>>24]<<24^a[r++],i[3]=c[255&s[3]]^c[s[0]>>>8&255]<<8^c[s[1]>>>16&255]<<16^c[s[2]>>>24]<<24^a[r++],OoAes._put32x4(t,i)}decrypt(t,e){var s=[0,0,0,0],i=[0,0,0,0],o=oo.aes.inv_sub_byte_mix_column_bd9e_table,a=this._decrypt_round_key,r=0;OoAes._get32x4(s,e);for(var n=0;n<4;n++)s[n]^=a[r++];for(var h=this._num_rounds-1;h>=1;h--)i[0]=o[255&s[0]]^OoAes._leftRotate32(o[s[3]>>>8&255],8)^OoAes._leftRotate32(o[s[2]>>>16&255],16)^OoAes._leftRotate32(o[s[1]>>>24],24)^a[r++],i[1]=o[255&s[1]]^OoAes._leftRotate32(o[s[0]>>>8&255],8)^OoAes._leftRotate32(o[s[3]>>>16&255],16)^OoAes._leftRotate32(o[s[2]>>>24],24)^a[r++],i[2]=o[255&s[2]]^OoAes._leftRotate32(o[s[1]>>>8&255],8)^OoAes._leftRotate32(o[s[0]>>>16&255],16)^OoAes._leftRotate32(o[s[3]>>>24],24)^a[r++],i[3]=o[255&s[3]]^OoAes._leftRotate32(o[s[2]>>>8&255],8)^OoAes._leftRotate32(o[s[1]>>>16&255],16)^OoAes._leftRotate32(o[s[0]>>>24],24)^a[r++],[s,i]=[i,s];var c=oo.aes.inv_sub_bytes_table;i[0]=c[255&s[0]]^c[s[3]>>>8&255]<<8^c[s[2]>>>16&255]<<16^c[s[1]>>>24]<<24^a[r++],i[1]=c[255&s[1]]^c[s[0]>>>8&255]<<8^c[s[3]>>>16&255]<<16^c[s[2]>>>24]<<24^a[r++],i[2]=c[255&s[2]]^c[s[1]>>>8&255]<<8^c[s[0]>>>16&255]<<16^c[s[3]>>>24]<<24^a[r++],i[3]=c[255&s[3]]^c[s[2]>>>8&255]<<8^c[s[1]>>>16&255]<<16^c[s[0]>>>24]<<24^a[r++],OoAes._put32x4(t,i)}encrypt_simple(t,e){var s=[0,0,0,0];OoAes._get32x4(s,e),this._addRoundKey(s,0);for(var i=1;i<this._num_rounds;i++)OoAes._subBytes(s),OoAes._shiftRows(s),OoAes._mixColumns(s),this._addRoundKey(s,i);OoAes._subBytes(s),OoAes._shiftRows(s),this._addRoundKey(s,this._num_rounds),OoAes._put32x4(t,s)}decrypt_simple(t,e){var s=[0,0,0,0];OoAes._get32x4(s,e),this._addRoundKey(s,this._num_rounds);for(var i=this._num_rounds-1;i>=1;i--)OoAes._invShiftRows(s),OoAes._invSubBytes(s),this._addRoundKey(s,i),OoAes._invMixColumns(s);OoAes._invShiftRows(s),OoAes._invSubBytes(s),this._addRoundKey(s,0),OoAes._put32x4(t,s)}encode(t){for(var e=[],s=(t.length+15)/16,i=new Array(16),o=0;o<s;o++){var a=t.slice(16*o,16*(o+1));this.encrypt(i,a);for(var r=0;r<16;r++)e[16*o+r]=i[r]}return e}decode(t){for(var e=[],s=t.length/16,i=new Array(16),o=0;o<s;o++){var a=t.slice(16*o,16*(o+1));this.decrypt(i,a);for(var r=0;r<16;r++)e[16*o+r]=i[r]}return e}}(oo=oo||{}).asyncCreateApng=function(t,e){var s=new OoApng,i=new XMLHttpRequest;return i.open("GET",t,!0),i.responseType="arraybuffer",i.onload=(()=>{s.create(i.response),e()}),i.onerror=(()=>{e()}),i.onabort=i.onerror,i.ontimeout=i.onerror,i.send(),s};class OoApng extends OoRenderSprite{constructor(){super(),this.fps=60,this.current_frame=0,this.frame60=0,this.elapsed_time=0,this.time0=Date.now(),this.crc_table=[],this.makeCrcTable(),this.frames=[]}create(t){this.buffer=new Uint8Array(t);for(var e=new Uint8Array([137,80,78,71,13,10,26,10]),s=0;s<e.length;s++)if(this.buffer[s]!==e[s])return!1;var i=[],o={};o.IHDR=((t,e)=>{this.width=this.readUint32(t+8),this.height=this.readUint32(t+8+4),this.header={pos:t+8,length:e}}),o.acTL=(t=>{this.num_frames=this.readUint32(t+8),this.num_plays=this.readUint32(t+8+4)}),o.fcTL=(t=>{var e={};e.sequence_number=this.readUint32(t+8),e.width=this.readUint32(t+8+4),e.height=this.readUint32(t+8+8),e.x_offset=this.readUint32(t+8+12),e.y_offset=this.readUint32(t+8+16),e.delay_num=this.readUint16(t+8+20),e.delay_den=this.readUint16(t+8+22),e.dispose_op=this.readUint8(t+8+24),e.blend_op=this.readUint8(t+8+25),e.data=[],this.frames.push(e)}),o.fdAT=((t,e)=>{var s=this.frames.length;s&&this.frames[s-1].data.push({pos:t+8+4,length:e-4})}),o.IDAT=((t,e)=>{var s=this.frames.length;s&&this.frames[s-1].data.push({pos:t+8,length:e})}),o[""]=((t,e)=>{i.push({pos:t,length:12+e})});for(var a=8;;){var r=this.readUint32(a),n=this.readString(a+4,4);if("IEND"===n)break;if(void 0===o[n]&&(n=""),o[n](a,r),(a+=12+r)>=this.buffer.size)break}for(s=0;s<this.frames.length;s++){var h=this.frames[s],c=[];c.push(e);var l=this.makeU8(this.header);this.writeUint32(l,0,h.width),this.writeUint32(l,4,h.height),c.push(this.makeChunk("IHDR",l,0,l.length));for(var u=0;u<i.length;u++)c.push(this.makeU8(i[u]));for(u=0;u<h.data.length;u++)c.push(this.makeChunk("IDAT",this.buffer,h.data[u].pos,h.data[u].length));c.push(this.makeChunk("IEND",null,0,0));var _=new Blob(c,{type:"image/png"});h.img=new Image,h.img.src=URL.createObjectURL(_),h.img.onload=function(){},h.img.onerror=function(){oo.log("oo_apng : create error")}}super.create(this.width,this.height)}makeU8(t){for(var e=new Uint8Array(t.length),s=0;s<t.length;s++)e[s]=this.buffer[t.pos+s];return e}makeChunk(t,e,s,i){var o=t.length+i,a=new Uint8Array(o+8);this.writeUint32(a,0,i),this.writeString(a,4,t);for(var r=t.length+4,n=0;n<i;n++)a[r+n]=e[s+n];var h=this.getCrc(a,4,o);return this.writeUint32(a,o+4,h),a}makeCrcTable(){for(var t=0;t<256;t++){for(var e=t,s=0;s<8;s++)e=1&e?e>>>1^3988292384:e>>>1;this.crc_table[t]=e}}getCrc(t,e,s){return this.getCrcPlus(t,e,s,0)}getCrcPlus(t,e,s,i){i^=4294967295;for(var o=0;o<s;o++)i=i>>>8^this.crc_table[255&i^t[e+o]];return 4294967295^i}writeUint32(t,e,s){t[e+0]=s>>>24&255,t[e+1]=s>>>16&255,t[e+2]=s>>>8&255,t[e+3]=255&s}writeString(t,e,s){for(var i=0;i<s.length;i++)t[e+i]=s.charCodeAt(i)}readUint8(t){return this.buffer[t]}readUint16(t){return this.buffer[t]<<8|this.buffer[t+1]}readUint32(t){return this.readUint16(t)<<16|this.readUint16(t+2)}readString(t,e){for(var s="",i=0;i<e;i++)s+=String.fromCharCode(this.buffer[t+i]);return s}start(){this.time0=Date.now(),this.current_frame=0,this.frame_time0=0,this.canvas_context.clearRect(0,0,this.canvas.width,this.canvas.height);var t=this.frames[0];this.canvas_context.drawImage(t.img,t.x_offset,t.y_offset)}pushCanvas(){this.image_data=this.canvas_context.getImageData(0,0,this.canvas.width,this.canvas.height)}popCanvas(){this.canvas_context.putImageData(this.image_data,0,0)}update(){for(var t=Date.now()-this.time0;;){var e=this.frames[this.current_frame],s=e.delay_num,i=e.delay_den||100;if(this.frame_time0*i+1e3*s>t*i)break;if(this.frame_time0+=1e3*s/i,this.current_frame++,this.current_frame>=this.num_frames){this.start();break}1===e.dispose_op&&this.canvas_context.clearRect(0,0,this.canvas.width,this.canvas.height),2===e.dispose_op&&this.popCanvas(),2===(e=this.frames[this.current_frame]).dispose_op&&this.pushCanvas(),0===e.blend_op&&this.canvas_context.clearRect(e.x_offset,e.y_offset,e.width,e.height),this.canvas_context.drawImage(e.img,e.x_offset,e.y_offset)}}}class OoBenchmark{constructor(){this.num_rounds=10,this.num_times_digits=8,this.test_function=[],this.test_function_name=[]}addTestFunction(t,e){this.test_function_name.push(t),this.test_function.push(e)}getTime(t,e){var s=performance.now();return e(t),performance.now()-s}run(){var t=Math.pow(10,this.num_times_digits),e=[],s=[];oo.log("test count : "+t);for(var i=0;i<this.num_rounds;i++)oo.log("round : "+i),oo.each(this.test_function,(i,o)=>{e[o]=this.getTime(t,i),s[o]=Math.min(s[o]||e[o],e[o]),oo.log(".."+this.test_function_name[o]+" : "+e[o].toFixed(1))});oo.log("----"),oo.log("weight");var o=[];oo.each(this.test_function,(t,e)=>{o[e]=s[e]-s[0],oo.log(".."+this.test_function_name[e]+" : "+o[e].toFixed(1))}),oo.log("----"),oo.log("ratio"),oo.each(this.test_function,(t,e)=>{oo.log(".."+this.test_function_name[e]+" : "+(o[e]/o[1]).toFixed(1))}),oo.log("----")}}(oo=oo||{}).env=oo.env||{},oo.env.context=null,oo.env.font_family="'Hiragino Kaku Gothic ProN', 'sans-serif'",oo.blendMode={kNormal:0,kScreen:1,kAdd:2,kMul:3},oo.getCompositeOperationByBlendMode=function(t){let e="source-over";return t===oo.blendMode.kScreen&&(e="screen"),t===oo.blendMode.kAdd&&(e="lighter"),t===oo.blendMode.kMul&&(e="multiply"),e},oo.localAlpha=function(t,e,s){if(0!==e){var i=t.globalAlpha;t.globalAlpha=i*e,s(),t.globalAlpha=i}},oo.localComposite=function(t,e,s){var i=t.globalCompositeOperation;t.globalCompositeOperation=e,s(),t.globalCompositeOperation=i},oo.drawImage=function(t,e,s,i,o,a){if(e){var r=o||e.width,n=a||e.height;t.drawImage(e,s,i,r,n)}},oo.drawImageCenter=function(t,e,s,i,o,a){if(e){var r=o||e.width,n=a||e.height;t.drawImage(e,s-.5*r,i-.5*n,r,n)}},oo.drawPatchImage=function(t,e,s,i,o,a){if(e)for(var r=(e.width-2)/2,n=(e.height-2)/2,h=[0,r,r+2],c=[0,n,n+2],l=[r,2,r],u=[n,2,n],_=[s,s+r,s+o-r],d=[i,i+n,i+a-n],f=[r,o-2*r,r],p=[n,a-2*n,n],m=0;m<3;m++)for(var g=0;g<3;g++)t.drawImage(e,h[g],c[m],l[g],u[m],_[g],d[m],f[g],p[m])},oo.drawRoundRect=function(t,e,s,i,o,a,r,n){var h=void 0===a?5:a;void 0===n&&(n=!0),t.beginPath(),t.moveTo(e+h,s),t.lineTo(e+i-h,s),t.quadraticCurveTo(e+i,s,e+i,s+h),t.lineTo(e+i,s+o-h),t.quadraticCurveTo(e+i,s+o,e+i-h,s+o),t.lineTo(e+h,s+o),t.quadraticCurveTo(e,s+o,e,s+o-h),t.lineTo(e,s+h),t.quadraticCurveTo(e,s,e+h,s),t.closePath(),r&&t.fill(),n&&t.stroke()},oo.setTextAttributes=function(t,e,s,i,o){t.font=`${e}px `+oo.env.font_family,t.fillStyle=s,t.textAlign=i,t.textBaseline=o};var oo,resizeCanvasDrawImage=function(t,e,s,i){var o=document.getElementById(t);o.width=s.w*i,o.height=s.h*i,o.getContext("2d").drawImage(e,s.x,s.y,s.w,s.h,0,0,s.w*i,s.h*i)},saveCanvasImage=function(t,e,s,i){var o=document.getElementById(t),a=document.createElement("a");"jpg"===s&&(a.href=o.toDataURL("image/jpeg",i)),"png"===s&&(a.href=o.toDataURL("image/png")),a.download=e+"."+s,a.click()};(oo=oo||{}).base16={},oo.base16.encode=function(t){var e="";for(var s of t)e+=("0"+s.toString(16)).slice(-2);return e},oo.base16.decode=function(t){for(var e=[],s=t.length/2,i=0;i<s;i++)e[i]=Number.parseInt(t.substr(2*i,2),16);return e},oo.utf8bin={},oo.utf8bin.encode=function(t){for(var e=[],s=t.length,i=0;i<s;i++){var o=t.charCodeAt(i);if(o>=55296&&o<56320){i++;var a=t.charCodeAt(i);a>=56320&&a<57344&&(o=(o-55296&16383)<<10|a-56320&16383,o+=65536)}if(0===o)break;o<128?e.push(o):o<2048?(e.push(o>>6|192),e.push(63&o|128)):o<65536?(e.push(o>>12|224),e.push(o>>6&63|128),e.push(63&o|128)):(e.push(o>>18|240),e.push(o>>12&63|128),e.push(o>>6&63|128),e.push(63&o|128))}return e},oo.utf8bin.decode=function(t){for(var e="",s=t.length,i=0;i<s;i++){var o=t[i];if(0===o)break;o<128?o&=127:o<224?(o=(31&o)<<6,o|=63&t[i+1],i+=1):o<240?(o=(15&o)<<12,o|=(63&t[i+1])<<6,o|=63&t[i+2],i+=2):(o=(7&o)<<18,o|=(63&t[i+1])<<12,o|=(63&t[i+2])<<6,o|=63&t[i+3],i+=3),o<65536?e+=String.fromCharCode(o):(o-=65536,e+=String.fromCharCode(o>>>10|55296),e+=String.fromCharCode(16383&o|56320))}return e},(oo=oo||{}).env=oo.env||{},oo.env.debug_log=!1,oo.qq=function(t,e){return void 0!==t?t:e},oo.isObject=function(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)},oo.each=function(t,e,...s){if("string"==typeof e)for(var i of t)i[e].apply(i,s);if("function"==typeof e)for(var o=0;o<t.length;o++)e.call({},t[o],o,t)},oo.repeat=function(t,e){for(var s=0;s<t;s++)e(s)},oo.find=function(t,e){return e.indexOf(t)>=0},oo.clone=function(t){return Object.assign({},t)},oo.deepClone=function(t){if("object"!=typeof t)return t;if(null===t)return null;if(Array.isArray(t)){var e=[];for(var s of t)e.push(oo.deepClone(s));return e}var i={},o=Object.keys(t);for(var a of o)i[a]=oo.deepClone(t[a]);return i},oo.setupQuery=function(){var t={},e=function(e,s,i){var o;if("#"===e.charAt(0)){var a=e.substr(1);return(o=document.getElementById(a))||(t[a]?t[a]:null)}return"@"===e.charAt(0)?document.createTextNode(e.substr(1)):(o=document.createElement(e),void 0!==s&&("string"==typeof s?(s&&(t[o.id=s]=o),oo.isObject(i)&&Object.assign(o.style,i)):(oo.isObject(s.property)&&Object.assign(o,s.property),oo.isObject(s.style)&&Object.assign(o.style,s.style),o.id&&(t[o.id]=o))),o)};return Node.prototype.$=function(t,s,i){return this.appendChild(e(t,s,i))},e},oo.main=function(t){document.addEventListener("DOMContentLoaded",function(){t()},!1)},oo.csvToArray2=function(t){for(var e=t.length,s=!1,i="",o=[],a=[],r=0;r<e;r++){var n=t.charAt(r);if('"'!==n){if(!s){if(","===n){a.push(i),i="";continue}if("\n"===n){(i.length||a.length)&&(a.push(i),i=""),a.length&&(o.push(a),a=[]);continue}}i+=n}else s?r+1<e&&'"'===t.charAt(r+1)?(i+='"',r+=1):s=!1:s=!0}return i.length&&a.push(i),a.length&&o.push(a),o},oo.csvToObjectArray=function(t){for(var e=[],s=oo.csvToArray2(t),i=1;i<s.length;i++){for(var o={},a=0;a<s[i].length;a++)o[s[0][a]]=s[i][a];e.push(o)}return e},oo.backSlashToSlash=function(t){for(var e="",s=0;s<t.length;s++){var i=t.charAt(s);e+="\\"===i?"/":i}return e},oo.addPath=function(t,e){return"/"!==t.substr(-1)&&(t+="/"),t+e},oo.getFolder=function(t){var e=(t=oo.backSlashToSlash(t)).lastIndexOf("/");return t.substr(0,e+1)},oo.getFilename=function(t){var e=(t=oo.backSlashToSlash(t)).lastIndexOf("/");return t.substr(e+1)},oo.getNonExtension=function(t){var e=(t=oo.backSlashToSlash(t)).lastIndexOf(".");return e<0?t:t.substr(0,e)},oo.saveBlob=function(t,e){var s=document.createElement("a");s.href=URL.createObjectURL(e),s.download=t,s.click()},oo.saveBin=function(t,e){var s=new Uint8Array(e);oo.saveBlob(t,new Blob([s]))},oo.saveText=function(t,e){oo.saveBlob(t,new Blob([e],{type:"text/plain"}))},oo.loadText=function(t,e){var s=new XMLHttpRequest;s.open("GET",t,!0),s.onreadystatechange=function(){4===s.readyState&&(0!==s.status&&200!==s.status||e(s.response))},s.send("")},(oo=oo||{}).fxsRotationType={kNormal:0,kDirection:1},oo.fxsDirectionType={kNormal:0,kSphere:1,kDist:2,kCenter:3},oo.fxsDistributionType={kNone:0,kUniform:1,kBall:2,kSphere:3};class OoFxsLerpParam{constructor(t,e,s){this.a=void 0===t?0:t,this.b=void 0===e?0:e,this.p=void 0===s?0:s}}class OoFxsEmitterFrame{constructor(){this.frame_num=0,this.num_ppf=0,this.life_time=0,this.life_time_dist=0,this.direction_type=oo.fxsDirectionType.kNormal,this.direction=new Oo3DVector(0),this.direction_dist=0,this.velocity0=0,this.velocity1=0,this.distribution_type=oo.fxsDistributionType.kNone,this.position=new Oo3DVector(0),this.position_dist=new Oo3DVector(0),this.scale0=1,this.scale1=1,this.rotation0=0,this.rotation1=0,this.rotate_v0=0,this.rotate_v1=0,this.frame_offset_dist=0}}class OoFxsParticleFrame{constructor(){this.frame_num=0,this.scale=new Oo2DVector(1),this.alpha=1}}class OoFxsTypeBase{constructor(){this.frame_data=[],this.frame_lerp_array=[]}createFrameLerpArray(){for(var t=this.frame_data.length,e=0,s=0,i=0,o=0;o<t;o++){for(;e<this.frame_data[o].frame_num;e++){var a=this.frame_data[s].frame_num,r=this.frame_data[i].frame_num,n=oo.linearStep(a,r,e);this.frame_lerp_array[e]=new OoFxsLerpParam(s,i,n)}s=i,i=Math.min(i+1,t-1)}this.frame_lerp_array[e]=new OoFxsLerpParam(i,i,0)}getFrameLerpParam(t){if(t<0)return this.frame_lerp_array[0];var e=this.frame_lerp_array.length;return t>=e?this.frame_lerp_array[e-1]:this.frame_lerp_array[t]}getFrameData(t){var e=this.getFrameLerpParam(t);return this.frame_data[e.a]}}class OoFxsParticleType extends OoFxsTypeBase{constructor(t){super(),this.id="",this.loop=!1,this.total_frames=0,this.size=new Oo2DVector(1),this.center=new Oo2DVector(0),this.texture_file="",this.world=!1,oo.isObject(t)&&Object.assign(this,t)}getFrameData(t){var e=this.getFrameLerpParam(t),s=this.frame_data[e.a],i=this.frame_data[e.b],o=new OoFxsParticleFrame;return o.frame_num=t,o.alpha=oo.lerp(s.alpha,i.alpha,e.p),o.scale.x=oo.lerp(s.scale.x,i.scale.x,e.p),o.scale.y=oo.lerp(s.scale.y,i.scale.y,e.p),o}}class OoFxsEmitterType extends OoFxsTypeBase{constructor(t){super(),this.id="",this.loop=!1,this.total_frames=0,this.particle_name="",this.max_particles=0,oo.isObject(t)&&Object.assign(this,t)}}class OoFxsEmitterStatus{constructor(){this.show=!0,this.current_frame=-1,this.num_particles=0,this.emitter_type=null,this.particle_type=null,this.particle_status_array=[]}}class OoFxsParticleStatus{constructor(){this.current_frame=0,this.life_time=0,this.position=new Oo3DVector(0),this.velocity=new Oo3DVector(0),this.size=new Oo2DVector(1),this.scale=new Oo2DVector(1),this.rotation=0,this.rotate_v=0}}class OoFxs{constructor(){this.position=new Oo3DVector(0),this.random=new OoRandom}generateParticle(t,e,s){t.current_frame=-1,t.current_frame+=Math.floor(e.frame_offset_dist*Math.random()),t.life_time=e.life_time,t.position.set(e.position),e.distribution_type===oo.fxsDistributionType.kUniform&&(t.position.x+=e.position_dist.x*(2*Math.random()-1),t.position.y+=e.position_dist.y*(2*Math.random()-1),t.position.z+=e.position_dist.z*(2*Math.random()-1)),s.world&&t.position.add(this.position);var i=oo.lerp(e.velocity0,e.velocity1,Math.random());if(e.direction_type===oo.fxsDirectionType.kNormal&&(t.velocity.x=e.direction.x*i,t.velocity.y=e.direction.y*i,t.velocity.z=e.direction.z*i),e.direction_type===oo.fxsDirectionType.kSphere){var o=this.random.getSphere();t.velocity.x=o.x*i,t.velocity.y=o.y*i,t.velocity.z=o.z*i}var a=oo.lerp(e.scale0,e.scale1,Math.random());t.size.x=s.size.x*a,t.size.y=s.size.y*a,t.rotation=oo.lerp(e.rotation0,e.rotation1,Math.random()),t.rotate_v=oo.lerp(e.rotate_v0,e.rotate_v1,Math.random())}create(t,e){var s=new OoFxsEmitterStatus;s.emitter_type=t,s.particle_type=e,this.emitter_status=s,s.particle_status_array=[];for(var i=0;i<t.max_particles;i++)s.particle_status_array[i]=new OoFxsParticleStatus}update(){var t=this.emitter_status,e=t.emitter_type;t.current_frame++,e.loop&&(t.current_frame%=e.total_frames);var s=e.getFrameData(t.current_frame);let i=0;for(let e=0;e<t.num_particles;e++)t.particle_status_array[e].life_time<=0||(e!==i&&(t.particle_status_array[i]=t.particle_status_array[e]),i++);t.num_particles=i,t.particle_status_array.length=i;var o=t.num_particles;let a=s.num_ppf;a<1&&Math.random()<a&&(a=1),a=Math.floor(a);for(let i=0;i<a&&!(t.num_particles>=e.max_particles);i++)t.particle_status_array[o+i]=new OoFxsParticleStatus,this.generateParticle(t.particle_status_array[o+i],s,t.particle_type),t.num_particles++;for(let e=0;e<t.num_particles;e++){var r=t.particle_status_array[e];r.current_frame++;var n=t.particle_type.getFrameData(r.current_frame);r.life_time--,r.position.add(r.velocity),r.scale.set(n.scale),r.rotation+=r.rotate_v}}draw(t){t.save();for(var e=0;e<this.emitter_status.num_particles;e++){var s=this.emitter_status.particle_status_array[e],i=this.particle_type,o=s.size.x*s.scale.x,a=s.size.y*s.scale.y,r=s.position.x,n=s.position.y;i.world||(r+=this.position.x,n+=this.position.y),t.setTransform(1,0,0,1,0,0),t.translate(r,n),t.rotate(s.rotation*Math.PI/180),t.drawImage(this.image,-o*(.5+i.center.x),-a*(.5+i.center.y),o,a)}t.restore()}}class OoGameAnime{constructor(){this.times=30,this.counter=-1,this.effects=new Set,this.overwrite_effect=!1,this.overwrite_alpha=0,this.overwrite_blend_mode=oo.blendMode.kNormal,this.tile_effect=!1,this.tile_alpha=0,this.tile_color="#000000",this.scale=new Oo2DVector(1,1)}init(){this.counter=-1,this.effects.clear(),this.overwrite_effect=!1,this.overwrite_alpha=0,this.overwrite_blend_mode=oo.blendMode.kNormal,this.tile_effect=!1,this.tile_alpha=0,this.scale.set(1,1)}start(t){this.counter=0,this.effects.add(t)}onCompletion(){}update(){if(this.counter>=0){for(var t of this.effects)this[t].call(this);this.counter++,this.counter>=this.times&&(this.onCompletion(),this.init())}}pop(){this.scale.x=Math.pow(2,oo.attenuatedSineWave(this.counter,0,this.times,1,.1)),this.scale.y=Math.pow(2,oo.attenuatedSineWave(this.counter,0,this.times,1,.1))}push(){this.scale.x=Math.pow(2,-oo.attenuatedSineWave(this.counter,0,this.times,1.5,.1)),this.scale.y=Math.pow(2,oo.attenuatedSineWave(this.counter,0,this.times,1.5,.2))}add(){this.overwrite_effect=!0,this.overwrite_alpha=oo.attenuatedSineWave(this.counter,0,this.times,.5,.5),this.overwrite_blend_mode=oo.blendMode.kAdd}mul(){this.overwrite_effect=!0,this.overwrite_alpha=oo.attenuatedSineWave(this.counter,0,this.times,.5,.5),this.overwrite_blend_mode=oo.blendMode.kMul}tile(){this.tile_effect=!0,this.tile_alpha=oo.attenuatedSineWave(this.counter,0,this.times,.5,.5)}light(){this.add()}dark(){this.mul()}}class OoGameButton{constructor(t,e,s,i,o,a){this.context=null,this.show=!0,this.name=t,this.enable=!0,this.position=new Oo2DVector(e,s),this.size=new Oo2DVector(i,o),this.image=a,this.patch_image=!1,this.anime=new OoGameAnime,this.anime.onCompletion=(()=>{this.onCompletion()})}contains(t){var e=this.position.x-t.x,s=this.position.y-t.y;return!(Math.abs(e)>.5*this.size.x)&&!(Math.abs(s)>.5*this.size.y)}onClick(){}onCompletion(){}click(t){return!!this.contains(t)&&(this.onClick(),!0)}startAnime(t){this.anime.start(t)}update(){this.anime.update()}_drawCore(t){var e=this.size.x*this.anime.scale.x,s=this.size.y*this.anime.scale.y;this.patch_image?oo.drawPatchImage(t,this.image,this.position.x-.5*e,this.position.y-.5*s,e,s):oo.drawImage(t,this.image,this.position.x-.5*e,this.position.y-.5*s,e,s)}draw(t){if(this.show){var e=t||this.context||oo.env.context;this.image&&(this._drawCore(e),this.anime.overwrite_effect&&oo.localAlpha(e,this.anime.overwrite_alpha,()=>{var t=oo.getCompositeOperationByBlendMode(this.anime.overwrite_blend_mode);oo.localComposite(e,t,()=>{this._drawCore(e)})})),this.anime.tile_effect&&oo.localAlpha(e,this.anime.tile_alpha,()=>{e.fillStyle=this.anime.tile_color;var t=this.size.x*this.anime.scale.x,s=this.size.y*this.anime.scale.y;e.fillRect(this.position.x-.5*t,this.position.y-.5*s,t,s)})}}}(oo=oo||{}).env=oo.env||{},oo.env.os="";class OoGameFrame{constructor(){this.game_loop_type=2,this.fps=60,this.horizontal_scaling=!1,this.vertical_scaling=!1,this.screen_width=1080,this.screen_height=1920,this.scale=1,this.canvas,this.context,this.scene_array=[],this.scene_map=new Map,this.click_on=!1,this.click_position=new Oo2DVector(0),this.input=new OoGameInput,this.touch_on=!1,this.touch_press=!1,this.touch_position=new Oo2DVector(0),this.touch_delta=new Oo2DVector(0);try{this.audio_context=new AudioContext}catch(t){console.log("oo:new AudioContext() exception")}}addScene(t){t.frame=this,this.scene_array.push(t),this.scene_map.set(t.name,t)}startScene(t){this.setSceneStatus(t,oo.gameSceneStatus.kStart)}endScene(t){this.setSceneStatus(t,oo.gameSceneStatus.kEnd)}getScene(t){return this.scene_map.get(t)}setSceneStatus(t,e){var s=this.getScene(t);s&&(s.scene_status=e)}update(){var t=new OoGameInputStatus;for(var e of(t.touch_press=this.touch_press||this.touch_on,t.touch_position=this.touch_position.clone(),this.input.addStatus(t),this.touch_on=!1,this.touch_delta=new Oo2DVector(0),this.scene_array))e.scene_status===oo.gameSceneStatus.kActive&&e.update();for(e of this.scene_array)e.scene_status===oo.gameSceneStatus.kEnd&&(e.release(),e.scene_status=oo.gameSceneStatus.kInactive);for(e of this.scene_array)e.scene_status===oo.gameSceneStatus.kStart&&(e.create(),e.update(),e.scene_status=oo.gameSceneStatus.kActive)}render(){for(var t of this.scene_array)t.scene_status===oo.gameSceneStatus.kActive&&t.render();this.click_on=!1}setHorizontalScaling(){this.horizontal_scaling=!0}setVerticalScaling(){this.vertical_scaling=!0}setCanvasScaleWH(t,e,s){this.scale=Math.min(e/this.screen_width,s/this.screen_height),this.horizontal_scaling&&(this.scale=e/this.screen_width),this.vertical_scaling&&(this.scale=s/this.screen_height);var i=this.screen_width,o=this.screen_height;this.horizontal_scaling&&(o=Math.floor(this.screen_width*s/e)),this.vertical_scaling&&(i=Math.floor(this.screen_height*e/s)),t.width=i,t.height=o}createDrawEnv(t){t?this.setCanvasScaleWH(t,t.clientWidth,t.clientHeight):(oo.env.debug_log&&console.log("createDrawEnv:create canvas"),t=document.createElement("canvas"),document.body.appendChild(t),this.setCanvasScaleWH(t,document.body.clientWidth,document.body.clientHeight),t.style.width=Math.floor(t.width*this.scale)+"px",t.style.height=Math.floor(t.height*this.scale)+"px",t.style.position="absolute",t.style.backgroundColor="#000000",t.style.zIndex=1),this.canvas=t,this.context=t.getContext("2d")}clear(){"android"===oo.env.os?this.context.clearRect(0,0,this.canvas.width+1,this.canvas.height+1):this.context.clearRect(0,0,this.canvas.width,this.canvas.height)}setupInput(){var t=this,e=this.canvas;function s(s){var i=e.getBoundingClientRect(),o=(s.clientX-i.left)/t.scale,a=(s.clientY-i.top)/t.scale;return new Oo2DVector(o,a)}function i(s){var i=e.getBoundingClientRect(),o=(s.changedTouches[0].pageX-i.left)/t.scale,a=(s.changedTouches[0].pageY-i.top)/t.scale;return new Oo2DVector(o,a)}function o(e){e.preventDefault(),e.stopPropagation(),t.touch_press&&(t.touch_position=i(e)),t.touch_press=!1}"ontouchstart"in window?e.addEventListener("touchend",function(s){var i=e.getBoundingClientRect();t.click_on=!0,t.click_position.x=(s.changedTouches[0].pageX-i.left)/t.scale,t.click_position.y=(s.changedTouches[0].pageY-i.top)/t.scale},!1):e.addEventListener("click",function(s){var i=e.getBoundingClientRect();t.click_on=!0,t.click_position.x=(s.clientX-i.left)/t.scale,t.click_position.y=(s.clientY-i.top)/t.scale},!1),"ontouchstart"in window?(e.addEventListener("touchstart",function(e){e.preventDefault(),e.stopPropagation(),1===e.touches.length?(t.touch_press=!0,t.touch_on=!0,t.touch_position=i(e),t.touch_delta.set(0,0)):t.touch_press=!1},!1),e.addEventListener("touchmove",function(s){if(s.preventDefault(),s.stopPropagation(),t.touch_press){var o=i(s);t.touch_delta.add(o).sub(t.touch_position),t.touch_position=o,o.x<0&&(t.touch_press=!1),o.y<0&&(t.touch_press=!1),o.x>=e.width&&(t.touch_press=!1),o.y>=e.height&&(t.touch_press=!1)}},!1),e.addEventListener("touchend",o,!1),e.addEventListener("touchcancel",o,!1)):(e.addEventListener("mousedown",function(e){t.touch_press=!0,t.touch_on=!0,t.touch_position=s(e)},!1),e.addEventListener("mousemove",function(e){var i=s(e);t.touch_delta.add(i).sub(t.touch_position),t.touch_position=i},!1),e.addEventListener("mouseup",function(e){t.touch_press=!1,t.touch_position=s(e)},!1))}setupGameLoop(){var t=this,e=this.fps;if(0===this.game_loop_type&&setInterval(function(){t.update(),t.render()},1e3/e),1===this.game_loop_type&&setTimeout(function s(){setTimeout(s,1e3/e),t.update(),t.render()},1e3/e),2===this.game_loop_type&&requestAnimationFrame(function e(){requestAnimationFrame(e),t.update(),t.render()}),3===this.game_loop_type){var s=Date.now(),i=0;setInterval(function(){var o=Date.now(),a=o-s;if(!(a<1e3/e)){if(s=o-Math.min(a-1e3/e,8),i){if((i+=1)<60)return;cancelAnimationFrame(r)}i=1;var r=requestAnimationFrame(()=>{t.update(),t.render(),i=0})}},8)}}}class OoGameInputStatus{constructor(){this.touch_press=!1,this.touch_position=new Oo2DVector(0),this.touch_delta=new Oo2DVector(0)}}class OoGameInput{constructor(){this.click_on=!1,this.click_position=new Oo2DVector(0),this.status_array=[],this.status_array[0]=new OoGameInputStatus,this.status_array[1]=new OoGameInputStatus,this._element=document,this._scale=1,this._click_on=!1,this._click_position=new Oo2DVector(0),this._touch_on=!1,this._touch_press=!1,this._touch_position=new Oo2DVector(0)}addStatus(t){this.status_array.pop(),this.status_array.unshift(t)}getTouchPosition(){return this.status_array[0].touch_position}getTouchDelta(){return this.status_array[0].touch_delta}isTouch(){return!0===this.status_array[0].touch_press}isTouchStart(){return!0===this.status_array[0].touch_press&&!1===this.status_array[1].touch_press}isTouchEnd(){return!1===this.status_array[0].touch_press&&!0===this.status_array[1].touch_press}setup(t,e){t&&(this._element=t),e&&(this._scale=e),"ontouchstart"in window?(this._element.addEventListener("touchend",t=>this._tapListener(t),!1),this._element.addEventListener("touchstart",t=>this._onTouchStart(t),!1),this._element.addEventListener("touchmove",t=>this._onTouchMove(t),!1),this._element.addEventListener("touchend",t=>this._onTouchEnd(t),!1),this._element.addEventListener("touchcancel",t=>this._onTouchEnd(t),!1)):(this._element.addEventListener("click",t=>this._clickListener(t),!1),this._element.addEventListener("mousedown",t=>this._onMouseDown(t),!1),this._element.addEventListener("mousemove",t=>this._onMouseMove(t),!1),this._element.addEventListener("mouseup",t=>this._onMouseUp(t),!1))}update(){var t=new OoGameInputStatus;t.touch_press=this._touch_press||this._touch_on,t.touch_position=this._touch_position.clone(),this.addStatus(t),this.click_on=this._click_on,this.click_position=this._click_position.clone(),this._touch_on=!1,this._click_on=!1}_getEventPositionMouse(t){var e=this._element.getBoundingClientRect(),s=t.clientX-e.left,i=t.clientY-e.top;return Oo2DVector.create(s,i).mul(this._scale)}_getEventPositionTouch(t){var e=this._element.getBoundingClientRect(),s=(t.changedTouches[0].pageX-e.left)*this._scale,i=(t.changedTouches[0].pageY-e.top)*this._scale;return new Oo2DVector(s,i)}_clickListener(t){this._click_on=!0,this._click_position=this._getEventPositionMouse(t)}_tapListener(t){this._touch_press&&(this._click_on=!0,this._click_position=this._getEventPositionTouch(t))}_onTouchStart(t){1===t.touches.length?(this._touch_press=!0,this._touch_on=!0,this._touch_position=this._getEventPositionTouch(t)):this._touch_press=!1}_onTouchMove(t){var e=this._element.getBoundingClientRect(),s=t.changedTouches[0].pageX,i=t.changedTouches[0].pageY;(s<e.left||s>=e.right||i<e.top||i>=e.bottom)&&(this._touch_press=!1),this._touch_press&&(this._touch_position=this._getEventPositionTouch(t)),this._touch_position=new Oo2DVector(s,i),t.preventDefault(),t.stopPropagation()}_onTouchEnd(t){this._touch_press&&(this._touch_press=!1,this._touch_position=this._getEventPositionTouch(t))}_onMouseDown(t){this._touch_press=!0,this._touch_on=!0,this._touch_position=this._getEventPositionMouse(t)}_onMouseMove(t){this._touch_position=this._getEventPositionMouse(t)}_onMouseUp(t){this._touch_press=!1,this._touch_position=this._getEventPositionMouse(t)}}class OoGameLayoutCell{constructor(){this.show=!0,this.name="",this.parent="",this.order=0,this.alpha=1,this.align=0,this.x=0,this.y=0,this.w=0,this.h=0,this.border=!1,this.text="",this.fontsize=0,this.color="#000000",this.bold=!1,this.wrap=!1,this.image="",this.img=null,this.rect=new OoRect}updateRect(t){this.rect||(this.rect=new OoRect(0,0,t.screen_width,t.screen_height));var e=t.cell_map.get(this.parent);if(e){var s=e.getAlignedRect(t);s&&this.rect.set(s)}}getAlignedRect(t){this.rect||this.updateRect(t);var e=new OoRect(this.x,this.y,this.w,this.h);return oo.alignedRect(this.rect,e,this.align)}getImageRect(){if(this.img){var t=new OoRect(this.x,this.y,this.img.width,this.img.height);return oo.alignedRect(this.rect,t,this.align)}}draw(t,e,s){var i=void 0===e?0:e,o=void 0===s?0:s,a=t.globalAlpha;if(this.alpha<1&&(t.globalAlpha=a*this.alpha),this.border){var r=new OoRect(this.x,this.y,this.w,this.h),n=oo.alignedRect(this.rect,r,this.align);t.strokeStyle=this.color,t.beginPath(),t.strokeRect(n.x+i,n.y+o,n.w,n.h)}if(this.img&&this.img.width){var h=new OoRect(this.x,this.y,this.img.width,this.img.height);n=oo.alignedRect(this.rect,h,this.align),t.drawImage(this.img,n.x+i,n.y+o)}if(this.text){var c="";this.bold&&(c+="bold "),c+=this.fontsize+"px ",c+=" ''",t.font=c,t.fillStyle=this.color,t.textAlign="left",t.textBaseline="top";var l=oo.clamp(this.align,1,9),u=new OoRect(this.x,this.y,0,0);n=oo.alignedRect(this.rect,u,l);t.textAlign=["left","center","right"][(l+2)%3],t.textBaseline=["top","middle","bottom"][Math.floor((l-1)/3)],t.fillText(this.text,n.x+i,n.y+o)}t.globalAlpha=a}}class OoGameLayout{constructor(){this.layout_name="",this.image_base_path="",this.display_width=108,this.display_height=192,this.screen_width=1080,this.screen_height=1920,this.cells=[],this.cell_map=new Map,this.cell_order=[],this.offset=new Oo2DVector(0),this.context}draw(t){var e=t||this.context||oo.env.context;for(var s of(0===this.cell_order.length&&(this.cell_order=this.cells.slice()),this.cell_order))s.rect||s.updateRect(this),s.show&&s.draw(e,this.offset.x,this.offset.y)}drawCell(t,e){var s=e||this.context||oo.env.context,i=this.getCell(t);i.rect||i.updateRect(this),i.draw(s,this.offset.x,this.offset.y)}updateCellMap(){for(var t of(this.cell_map.clear(),this.cells))t.name&&this.cell_map.set(t.name,t)}updateCoordinate(){for(var t of this.cells)t.rect=null;for(t of this.cells)t.updateRect(this)}updateOrder(){this.cell_order=this.cells.slice(),oo.sort(this.cell_order,function(t,e){return t.order>e.order?1:0})}getCell(t){return this.cell_map.get(t)}getCellImage(t){return this.cell_map.get(t).img}loadJson(t){var e=JSON.parse(t);this.loadJsonObj(e)}loadJsonObj(t){for(var e of(this.layout_name=t.layout_name,this.image_base_path=t.image_base_path,this.display_width=t.display_width,this.display_height=t.display_height,this.screen_width=t.screen_width,this.screen_height=t.screen_height,t.cells)){var s=new OoGameLayoutCell;Object.assign(s,e),this.cells.push(s)}this.updateCellMap(),this.updateCoordinate(),this.updateOrder()}asyncLoadImage(t){var e=this;oo.parallel(function*(t){for(var s of e.cells)if(s.image){let i=oo.addPath(e.image_base_path,s.image);s.img=oo.asyncCreateImage(i,t),yield}},t)}asyncSetupFromFile(t,e){var s=this;oo.serial(function*(t){var i=oo.asyncLoadText(e,t);yield,s.loadJson(i.text),s.asyncLoadImage(t),yield},t)}}(oo=(oo=oo||{})||{}).gameSceneStatus={kInactive:0,kActive:1,kStart:2,kEnd:3};class OoGameScene{constructor(){this.frame=null,this.name="",this.scene_status=oo.gameSceneStatus.kInactive,this.next_scene="",this.scene_end=!1,this.fade_times=60,this.fade_counter=0,this.fade_alpha=0}release(){}preload(){}create(){}update(){}render(){}changeSceneOnFadeOut(){""!==this.next_scene&&(this.frame.endScene(this.name),this.frame.startScene(this.next_scene))}fadeIn(){this.fade_counter=-this.fade_times,this.setFadeAlpha()}fadeOut(){this.fade_counter=1,this.setFadeAlpha()}setFadeAlpha(){this.fade_alpha=oo.saturate(Math.abs(this.fade_counter/this.fade_times))}updateFade(){this.setFadeAlpha(),0!==this.fade_counter&&this.fade_counter++,this.fade_counter===this.fade_times+2&&this.changeSceneOnFadeOut()}renderFade(){this.frame.canvas.style.opacity=1-this.fade_alpha}}class OoGameScroll{constructor(){this.touch_pos=new Oo2DVector(0,0),this.pos_delta=[],this.pos_delta[0]=new Oo2DVector(0,0),this.pos_delta[1]=new Oo2DVector(0,0),this.velocity=new Oo2DVector(0,0),this.offset=new Oo2DVector(0,0),this.y_min=0,this.y_max=1e3,this.x_min=0,this.x_max=1e3,this.resistance=3,this.attenuation=.95,this.attenuation_out=.95,this.resilience=.9}update(t){t.isTouchStart()&&(this.touch_pos=t.getTouchPosition()),t.isTouch()&&(this.pos_delta[1]=this.pos_delta[0],this.pos_delta[0]=Oo2DVector.sub(t.getTouchPosition(),this.touch_pos),this.touch_pos=t.getTouchPosition(),this.velocity.x=.5*(this.pos_delta[0].x+this.pos_delta[1].x),this.velocity.y=.5*(this.pos_delta[0].y+this.pos_delta[1].y));var e=this.velocity.x,s=this.velocity.y;return this.offset.x>=this.x_min&&this.offset.x+e<=this.x_min&&(e-=this.x_min-this.offset.x),this.offset.x<=this.x_max&&this.offset.x+e>=this.x_max&&(e-=this.x_max-this.offset.x),this.offset.x<=this.x_min&&this.velocity.x<0&&(e/=this.resistance),this.offset.x>=this.x_max&&this.velocity.x>0&&(e/=this.resistance),this.offset.y>=this.y_min&&this.offset.y+s<=this.y_min&&(s-=this.y_min-this.offset.y),this.offset.y<=this.y_max&&this.offset.y+s>=this.y_max&&(s-=this.y_max-this.offset.y),this.offset.y<=this.y_min&&this.velocity.y<0&&(s/=this.resistance),this.offset.y>=this.y_max&&this.velocity.y>0&&(s/=this.resistance),this.offset.x+=e,this.offset.y+=s,t.isTouch()||(this.velocity.mul(this.attenuation),this.offset.x<=this.x_min&&this.velocity.x<0&&(this.velocity.x*=this.attenuation_out),this.offset.x>=this.x_max&&this.velocity.x>0&&(this.velocity.x*=this.attenuation_out),this.offset.y<=this.y_min&&this.velocity.y<0&&(this.velocity.y*=this.attenuation_out),this.offset.y>=this.y_max&&this.velocity.y>0&&(this.velocity.y*=this.attenuation_out),this.offset.x<this.x_min&&(this.offset.x=(this.offset.x-this.x_min)*this.resilience+this.x_min),this.offset.x>this.x_max&&(this.offset.x=(this.offset.x-this.x_max)*this.resilience+this.x_max),this.offset.y<this.y_min&&(this.offset.y=(this.offset.y-this.y_min)*this.resilience+this.y_min),this.offset.y>this.y_max&&(this.offset.y=(this.offset.y-this.y_max)*this.resilience+this.y_max)),this.getOffset()}getOffset(){return this.offset}}(oo=oo||{}).kPi=3.141592653589793,oo.k2Pi=6.283185307179586,oo.kPi2=1.5707963267948966,oo.kInvPi=.3183098861837907,oo.kDeg2Rad=.017453292519943295,oo.kRad2Deg=57.29577951308232,oo.kE=2.718281828459045,oo.clamp=function(t,e,s){return t<e?e:t>s?s:t},oo.square=function(t){return t*t},oo.lerp=function(t,e,s){return(1-s)*t+s*e},oo.saturate=function(t){return t<0?0:t>1?1:t},oo.linearStep=function(t,e,s){return t===e?0:oo.saturate((s-t)/(e-t))},oo.smoothStep=function(t,e,s){var i=oo.linearStep(t,e,s);return i*i*(3-2*i)},oo.sigmoid=function(t){return 1/(1+Math.exp(-t))},oo.sigmoidStep=function(t,e){if(t<=0)return 0;if(t>=1)return 1;var s=2*t-1,i=1/(1+Math.exp(-s*e)),o=Math.exp(-e);return(1+o)/(1-o)*(i-.5)+.5},oo.sineStep=function(t){return.5-.5*Math.cos(t*Math.PI)},oo.attenuatedSineWave=function(t,e,s,i,o){var a=1-t/(s-e),r=i*oo.k2Pi*t/(s-e);return a*Math.sin(r)*o},oo.getIntersectionPoint=function(t,e,s,i){if(!(Oo2DVector.distance(t,s)>e+i)){var o=Oo2DVector.lerp(t,s,e/(e+i)),a=Oo2DVector.distance(t,o),r=Math.sqrt(e*e-a*a),n=Oo2DVector.sub(s,t).rotate90().normalize().mul(r);return[o.clone().add(n),o.clone().sub(n)]}},(oo=oo||{}).drawPointLightImage=function(t,e,s,i,o){for(var a,r,n,h,c=t.size.x,l=t.size.y,u=t.size.clone().mul(.5).sub(.5),_=s.clone().div(t.size),d=Oo2DVector.create(2,2).div(t.size),f=function(t){var e=Math.sqrt(t),s=1;return-1===o&&(s=1/Math.sqrt(e)),1===o&&(s=1/e),2===o&&(s=1/t),s},p=f(oo.square(.5*Math.min(s.x,s.y))),m=0;m<l;m++)for(var g=0;g<c;g++){var y=Oo2DVector.create(g,m).sub(u),v=y.clone().mul(_),x=p*y.clone().mul(d).getMagnitude(),w=(f(v.getMagnitudeSquared())-x)*i;a=e[0]*w,r=e[1]*w,n=e[2]*w,h=255,t.setPixel(g,m,[a,r,n,h])}},(oo=oo||{}).$=function(){var t={},e=function(e){if(!e)return null;if("string"==typeof e){if("#"===e.charAt(0)){var s=e.substr(1);return document.getElementById(s)||t[s]}return"@"===e.charAt(0)?document.createTextNode(e.substr(1)):document.createElement(e)}if("object"==typeof e){if(e instanceof Node)return e;if(e.tag){var i=document.createElement(e.tag);if(i)return e.property&&Object.assign(i,e.property),e.style&&Object.assign(i.style,e.style),e.id&&(i.id=e.id),i.id&&(t[i.id]=i),i}}return null};return function(...t){if(0===t.length)return null;var s=e(t[0]);if(s)for(var i=s,o=1;o<t.length;o++){var a=null,r=t[o];if(Array.isArray(r))for(var n=0;n<r.length;n++)(a=e(r[n]))&&i.appendChild(a);else(a=e(r))&&(i=i.appendChild(a))}return s}};class OoRandom{constructor(t){this.init(t)}init(t){this.x=123456789,this.y=362436069,this.z=521288629,this.w=88675123,void 0!==t&&(this.seed=t),void 0!==this.seed&&(this.w=this.seed),this.nd_idx=0,this.nd_work=0}getUint32(){var t=this.x^this.x<<11;return this.x=this.y,this.y=this.z,this.z=this.w,this.w=this.w^this.w>>>19^t^t>>>8,this.w=this.w>>>0,this.w}get(){return this.getUint32()/4294967296}get1(){return this.getUint32()/4294967295}get2(){return this.getUint32()/2147483648-1}getND(){if(this.nd_idx^=1,0===this.nd_idx)return this.nd_work;do{var t=this.get2(),e=this.get2(),s=t*t+e*e}while(s>1||0===s);return s=Math.sqrt(-2*Math.log(s)/s),this.nd_work=e*s,t*s}getRange(t,e){return t+this.get1()*(e-t)}getIntRange(t,e){return t+this.roll0(e-t+1)}roll0(t){return t=t||6,this.getUint32()%t}roll(t){return this.roll0(t)+1}getUniform3(){var t=this.get2(),e=this.get2(),s=this.get2();return new Oo3DVector(t,e,s)}getBall(){do{var t=this.get2(),e=this.get2(),s=this.get2()}while(t*t+e*e+s*s>1);return new Oo3DVector(t,e,s)}getSphere(){var t=this.get2(),e=Math.sqrt(1-t*t),s=this.get()*Math.PI*2,i=e*Math.cos(s),o=e*Math.sin(s);return new Oo3DVector(i,o,t)}}(oo=oo||{}).env=oo.env||{},oo.env.default_align=1;class OoRect{constructor(t,e,s,i){this.x=t||0,this.y=e||0,this.w=s||0,this.h=i||0}clone(){return new OoRect(this.x,this.y,this.w,this.h)}set(t,e,s,i){t instanceof OoRect?Object.assign(this,t):Object.assign(this,{x:t,y:e,w:s,h:i})}contains(t,e){return t instanceof Oo2DVector&&([t,e]=[t.x,t.y]),!(t<this.x||t>=this.x+this.w)&&!(e<this.y||e>=this.y+this.h)}alignRect(t,e){this.set(oo.alignedRect(t,this,e))}}oo.alignX=function(t,e){return 0===t&&(t=oo.env.default_align),e*((t+2)%3)/2},oo.alignY=function(t,e){return 0===t&&(t=oo.env.default_align),e*Math.floor((t-1)/3)/2},oo.alignedRect=function(t,e,s){var i=t,o=e,a=Math.floor(s/10)%10,r=s%10;0===r&&(r=oo.env.default_align),0===a&&(a=r);var n=i.x+o.x+oo.alignX(a,i.w)-oo.alignX(r,o.w),h=i.y+o.y+oo.alignY(a,i.h)-oo.alignY(r,o.h);return new OoRect(n,h,o.w,o.h)},(oo=oo||{}).sort=function(t,e){var s=function(i,o){if(!(i>=o))if(o-i!=1){var a,r,n,h,c=Math.floor((i+o)/2);s(i,c),s(c+1,o);for(var l=[],u=0,_=i;_<=c;_++)l[u++]=t[_];_=c+1;for(var d=0,f=i;_<=o&&d<u;)t[f++]=e(l[d],t[_])<=0?l[d++]:t[_++];for(;d<u;)t[f++]=l[d++]}else e(t[i],t[o])>0&&(n=o,h=(a=t)[r=i],a[r]=a[n],a[n]=h)};s(0,t.length-1)};class OoSound{constructor(t,e){if(t){this.context=t,this.name=e,this.buffer;var s=this,i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType="arraybuffer",i.onreadystatechange=function(){4===i.readyState&&(0!==i.status&&200!==i.status||s.context.decodeAudioData(i.response,function(t){s.buffer=t}))},i.send("")}}play(){if(this.context){var t=this.context.createBufferSource();t.buffer=this.buffer,t.connect(this.context.destination),t.start()}}}class OoStopMotion{constructor(){this.fps=60,this.image_base_path="",this.image_files=[],this.images=[],this.total_frames=0,this.current_frame=0,this.frame60=0,this.elapsed_time=0,this.time0=Date.now(),this.position=new Oo2DVector(0)}asyncLoadImage(t){var e=this.image_files.length;this.total_frames=e;var s=this;oo.parallel(function*(t){for(let o=0;o<e;o++){var i=oo.addPath(s.image_base_path,s.image_files[o]);s.images[o]=oo.asyncCreateImage(i,t),yield}},t)}start(){this.current_frame=0,this.frame60=0,this.elapsed_time=0,this.time0=Date.now()}updateByTime(){var t=Date.now();this.elapsed_time+=t-this.time0,this.time0=t,this.current_frame=Math.floor(this.elapsed_time*this.fps/1e3)}update(){this.frame60++,this.current_frame=Math.floor(this.frame60*this.fps/60)}draw(t){var e=oo.clamp(this.current_frame,0,this.images.length-1),s=this.images[e];t.drawImage(s,this.position.x,this.position.y)}}class OoTile extends OoDrawObject{constructor(t,e,s){super(),this.size=new Oo2DVector(1,1),this.color=t||"#ffffff"}draw(t){if(this.show){var e=t||this.context||oo.env.context;oo.localAlpha(e,this.alpha,()=>{var t=this.size.x*this.scale.x,s=this.size.y*this.scale.y;e.fillStyle=this.color,0===this.rotation.z?e.fillRect(this.position.x-.5*t,this.position.y-.5*s,t,s):(e.save(),e.setTransform(1,0,0,1,0,0),e.translate(this.position.x,this.position.y),e.rotate(this.rotation.z),e.fillRect(.5*-t,.5*-s,t,s),e.restore())})}}static create(t,e,s){var i=new OoTile;return i.color=t,i.size.set(e,s),i}}(oo=oo||{}).env=oo.env||{},oo.getArrayDiff=function(t,e){var s=[];for(let i of t)-1===e.indexOf(i)&&s.push(i);for(let i of e)-1===t.indexOf(i)&&s.push(i);return s},oo.setupLogEnv=function(){var t=null;oo.log=function(...e){if(console.log.apply(null,e),null===t&&document.body&&(t=document.createElement("div"),document.body.appendChild(t)),t){for(var s of e)"string"==typeof s?t.innerHTML+=s:("object"==typeof s&&(t.innerHTML+=s.constructor.name),t.innerHTML+=JSON.stringify(s));t.innerHTML+="<br>"}}},oo.log=function(...t){console.log.apply(null,t)},oo.getDataset=function(t,e){var s=document.getElementById(t);if(s)return s.dataset[e]},oo.strReplace=function(t,e,s){return t.split(e).join(s)},oo.strToInt=function(t){var e=0;return e="0x"===t.substr(0,2)||"0X"===t.substr(0,2)?Number.parseInt(t,16):Number.parseInt(t,10),Number.isInteger(e)?e:0},oo.dup=function(t,e){for(var s="",i=0;i<e;i++)s+=t;return s},oo.zeroPadding=function(t,e){return("00000000000000000000"+t).slice(-e)},oo.rgbColor=function(t,e,s){return"#"+("000000"+((255&t)<<16|(255&e)<<8|255&s).toString(16)).slice(-6)},oo.arraySwap=function(t,e,s){var i=t[e];t[e]=t[s],t[s]=i},oo.urlSearchParams=function(t){var e=new Map,s=t.split("&");for(var i of s){var o=i.split("=");1===o.length&&e.set(o[0],""),2===o.length&&e.set(o[0],o[1])}return e};class Oo2DVector{constructor(t,e){this.x=t||0,this.y=void 0!==e?e:this.x}clone(){return new Oo2DVector(this.x,this.y)}set(t,e){return oo.isObject(t)?(this.x=t.x||0,this.y=t.y||0):(this.x=t||0,this.y=e||0),this}add(t,e){return oo.isObject(t)?void 0!==e?(this.x+=(t.x||0)*e,this.y+=(t.y||0)*e):(this.x+=t.x||0,this.y+=t.y||0):(this.x+=t||0,this.y+=t||0),this}sub(t){return this.x-=(oo.isObject(t)?t.x:t)||0,this.y-=(oo.isObject(t)?t.y:t)||0,this}mul(t){return this.x*=(oo.isObject(t)?t.x:t)||0,this.y*=(oo.isObject(t)?t.y:t)||0,this}div(t){return this.x/=(oo.isObject(t)?t.x:t)||1,this.y/=(oo.isObject(t)?t.y:t)||1,this}clamp(t,e){return this.x<t&&(this.x=t),this.y<t&&(this.y=t),this.x>e&&(this.x=e),this.y>e&&(this.y=e),this}negate(){return this.x=-this.x,this.y=-this.y,this}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}rotate90(){return[this.x,this.y]=[-this.y,this.x],this}normalize(){var t=this.getMagnitude();return t>0&&(t=1/t),this.x*=t,this.y*=t,this}getNegation(){return this.clone().negate()}getRound(){return this.clone().round()}getNormal(){return this.clone().normalize()}getMagnitudeSquared(){return this.x*this.x+this.y*this.y}getMagnitude(){return Math.sqrt(this.getMagnitudeSquared())}getAtan2(){return Math.atan2(this.y,this.x)}getDegree(){return 180*Math.atan2(this.y,this.x)/Math.PI}static add(t,e){return t.clone().add(e)}static sub(t,e){return t.clone().sub(e)}static mul(t,e){return t.clone().mul(e)}static div(t,e){return t.clone().div(e)}static angle(t,e){return Math.acos(Oo2DVector.dot(e,t)/(e.getMagnitude()*t.getMagnitude()))}static dot(t,e){return t.x*e.x+t.y*e.y}static cross(t,e){return t.x*e.y-t.y*e.x}static distance(t,e){return Oo2DVector.sub(t,e).getMagnitude()}static lerp(t,e,s){return new Oo2DVector((1-s)*t.x+s*e.x,(1-s)*t.y+s*e.y)}static cubicBezierCurves(t,e,s,i,o){var a=1-o,r=a*a*a,n=3*a*a*o,h=3*a*o*o,c=o*o*o,l=new Oo2DVector(0,0);return l.add(t,r),l.add(e,n),l.add(s,h),l.add(i,c),l}static create(t,e){return new Oo2DVector(t,e)}}class Oo3DVector{constructor(t,e,s){this.x=t||0,this.y=void 0===e?this.x:e,this.z=void 0===s?this.y:s}clone(){return new Oo3DVector(this.x,this.y,this.z)}set(t,e,s){return oo.isObject(t)?(this.x=t.x||0,this.y=t.y||0,this.z=t.z||0):(this.x=t||0,this.y=e||0,this.z=s||0),this}add(t,e){return oo.isObject(t)?void 0!==e?(this.x+=(t.x||0)*e,this.y+=(t.y||0)*e,this.z+=(t.z||0)*e):(this.x+=t.x||0,this.y+=t.y||0,this.z+=t.z||0):(this.x+=t||0,this.y+=t||0,this.z+=t||0),this}sub(t){return this.x-=(oo.isObject(t)?t.x:t)||0,this.y-=(oo.isObject(t)?t.y:t)||0,this.z-=(oo.isObject(t)?t.z:t)||0,this}mul(t){return this.x*=(oo.isObject(t)?t.x:t)||0,this.y*=(oo.isObject(t)?t.y:t)||0,this.z*=(oo.isObject(t)?t.z:t)||0,this}div(t){return this.x/=(oo.isObject(t)?t.x:t)||1,this.y/=(oo.isObject(t)?t.y:t)||1,this.z/=(oo.isObject(t)?t.z:t)||1,this}clamp(t,e){return this.x<t&&(this.x=t),this.y<t&&(this.y=t),this.z<t&&(this.z=t),this.x>e&&(this.x=e),this.y>e&&(this.y=e),this.z>e&&(this.z=e),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}normalize(){var t=this.getMagnitude();return t>0&&(t=1/t),this.x*=t,this.y*=t,this.z*=t,this}getNegation(){return this.clone().negate()}getRound(){return this.clone().round()}getNormal(){return this.clone().normalize()}getMagnitudeSquared(){return this.x*this.x+this.y*this.y+this.z*this.z}getMagnitude(){return Math.sqrt(this.getMagnitudeSquared())}getAtan2(){return Math.atan2(this.y,this.x)}getDegree(){return 180*Math.atan2(this.y,this.x)/Math.PI}static add(t,e){return t.clone().add(e)}static sub(t,e){return t.clone().sub(e)}static mul(t,e){return t.clone().mul(e)}static div(t,e){return t.clone().div(e)}static angle(t,e){return Math.acos(Oo3DVector.dot(e,t)/(e.getMagnitude()*t.getMagnitude()))}static dot(t,e){return t.x*e.x+t.y*e.y+t.z*e.z}static cross(t,e){return new Oo3DVector(t.y*e.z-t.z*e.y,t.z*e.x-t.x*e.z,t.x*e.y-t.y*e.x)}static distance(t,e){return Oo3DVector.sub(t,e).getMagnitude()}static lerp(t,e,s){return new Oo3DVector((1-s)*t.x+s*e.x,(1-s)*t.y+s*e.y,(1-s)*t.z+s*e.z)}static cubicBezierCurves(t,e,s,i,o){var a=1-o,r=a*a*a,n=3*a*a*o,h=3*a*o*o,c=o*o*o,l=new Oo3DVector(0,0,0);return l.add(t,r),l.add(e,n),l.add(s,h),l.add(i,c),l}static create(t,e,s){return new Oo3DVector(t,e)}}(oo=oo||{}).wrapBeforeAfter=function(t,e,s){return function(...i){e&&e(...i);var o=t(...i);return s&&s(o),o}},oo.wrap=function(t,...e){var s=Object.keys(t)[0],i=t[s],o=e[0],a=e[1];if("function"==typeof o&&"function"==typeof o)return oo.wrapBeforeAfter(i,o,a);var r=e[0];if("string"==typeof r){if("log"===r)return oo.wrapBeforeAfter(i,()=>{oo.log("log:",s)},null);if("inout"===r)return oo.wrapBeforeAfter(i,()=>{oo.log("in:",s)},()=>{oo.log("out:",s)});var n;if("time"===r)return oo.wrapBeforeAfter(i,()=>{n=performance.now()},()=>{oo.log("time:",s," ",""+(performance.now()-n))});if("check"===r)return oo.wrapBeforeAfter(i,(...t)=>{oo.log("check:",s," ","args:",t)},t=>{oo.log("check:",s," ","result:",t)})}return i};